---
layout: single
title: Redis는 무엇이고 어떻게 사용할까?
excerpt: ""
---

## Redis란

- `key:value` 구조의 저장소
- In-memory 데이터 구조 저장소
- 지원하는 데이터 구조
  - Strings, set, sorted-set, hashes, list
  - Hyperloglog, bitmap, geospatial index
  - Strea m
- Only 1 Committer
  - Redis 소스 코드를 고칠 수 있는 권한이 있는 사람은 딱 한 명!

## Cache

> Redis는 캐싱에 많이 사용되므로 알아두면 도움이 된다.

**Cache의 정의**

- Cache는 나중에 요청올 결과를 미리 저장해두었다가 빠르게 서비스 해주는 것을 의미
  - ex) DP, 10! = 10 * 9!= 10 * 9 * 8! = 10 * 9 * 8 * 7! (팩토리얼 숫자가 크다면 미리 캐싱해두면 연산이 훨씬 빨라짐)
- 파레토 법칙
  - 20:80 법칙으로, 우리 사회에서 일어나는 현상의 80%는 20%의 원인으로 인하여 발생
  - 즉, 전체 트래픽의 80%는 20%의 특정 데이터 요청

<br>

### 웹 서버에서 사용되는 Cache 구조

![img](/assets/images/Redis.png)

- 캐싱을 적용하지 않은 구조로, DB안에 모든 데이터가 존재하는 구조
- 디스크에 데이터를 저장하는 일반적인 구조

### Look aside Cache

![img](/assets/images/Redis2.png)

- Web Server는 데이터가 존재하는지 Cache를 연계 확인
  - Cache에 데이터가 있으면 Cache에서 가져온다.
  - Cache에 데이터가 없으면 DB에서 데이터를 가져와 Cache에 저장하고 값을 가져온다.

### Write Back

![img](/assets/images/Redis2.png)

- Web Server는 모든 데이터를 Cache에만 저장
  - Cache에 특정 시간동안의 데이터가 저장된다.
  - 그리고 배치처리를 통해 Cache에 있는 데이터를 DB에 저장한다.
  - DB에 저장되었다면 Cache에는 해당 데이터를 삭제한다.
- 이 방식의 단점
  - 서버 장애가 생기면 데이터가 날아갈 수도 있다.
  - Cache에 업데이트 하고 메모리에는 바로 업데이트를 하지 않기 때문에, Cache와 메모리가 서로 값이 다른 경우가 발생할 수 있다.
  - 그래서 데이터 손실 위험을 줄이기 위해 로그를 Redis에 넣어두고 배치적으로 데이터를 저장할 때 많이 사용된다.

> insert 쿼리를 한번씩 500번 날리는 것과 insert 쿼리 한번에 500개를 붙여서 날리는 것중 어느 것이 더 빠를까?

후자가 훨씬 빠르다. Write Back 방식은 이와 같은 원리를 활용하여 데이터가 일시적으로 캐시에만 저장되고, 이후 배치 작업을 통해 DB에 한꺼번에 기록한다.








